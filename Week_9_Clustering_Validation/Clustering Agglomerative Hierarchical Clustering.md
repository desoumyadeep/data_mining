# Clustering: Agglomerative Hierarchical Clustering

In this programming assignment, we're going to implement the agglomerative hierarchical clustering algorithm. We will implement three different cluster similarity measures: **single link**, **complete link**, and **average link**.

We will be using geographical data for this assignment. Each of the data points is a 2-D vector, with longitude and latitude as its dimensions.

Here is a brief review of the agglomerative clustering. During the clustering process, we iteratively aggregate the most similar two clusters, until there are clusters left. For initialization, each data point forms its own cluster.

The similarity of two clusters is determined by a distance measure. We use the following three measures in this assignment:

> **Single link**:

$$
D(C_i,C_j) = min(d(v_p,v_q)| v_p \epsilon C_i, v_q \epsilon C_j)
$$



> **Complete link**:

$$
D(C_i,C_j) = max(d(v_p,v_q)| v_p \epsilon C_i, v_q \epsilon C_j)
$$



> **Average link**:

$$
D(C_i,C_j) = mean(d(v_p,v_q)| v_p \epsilon C_i, v_q \epsilon C_j)
$$



The smaller the distance is, the more similar the two clusters are.

In the equations, is a distance measure between two data points. In this assignment, for simplicity, we use the **Euclidean distance**, defined by:
$$
d(p,q) = \sqrt{\sum_{i}(p_i -q_i)^2}
$$
where are dimensions of p,q.

**Input Format**

The first line of the input will be three space separated integers  : 

1. The number of data points (lines) following the first line .
2. The number of output clusters .
3. The cluster similarity measure to be used. for single link, for complete link, for average link.

Starting from the second line, each line will have exactly two floating point numbers, representing longitude and latitude of a location. Each line corresponds to a 2-D data point which will be fed into the clustering algorithm.

There will be lines in total.

Our objective is to use the similarity measure specified by to cluster data points into clusters.

**Output Format**

There should be lines in the output, and one integer for each line, indicating the cluster label of the data point. The -th line in the output corresponds to the -th data point in the input, i.e. the -th line in the input.

The exact numbers used for cluster labels don't matter, but there should be exactly unique labels, and the data points in the same cluster should share the same label.

**Sample Input 0**

```
5 2 0
150.8586 -33.5872
144.7548 -37.7099
31.4162 -28.3352
113.8974 30.5215
-110.5385 41.7794
```

**Sample Output 0**

```
0
0
0
0
1
```

**Sample Input 1**

```
20 2 1
115.5902 23.2552
2.8480 43.2274
153.0325 -27.5123
-1.2866 5.7012
14.4500 47.9500
-79.0670 42.6242
-46.1400 -1.1967
-0.5690 47.5350
-3.1527 34.9716
35.3629 32.5113
147.0481 -43.0312
76.5025 31.2393
115.9220 -32.8432
7.9335 5.0513
-75.1946 40.9868
32.8016 3.5297
-75.2502 39.9635
145.1080 -37.8179
65.1238 36.9529
7.0236 50.0093
```

**Sample Output 1**

```
1
0
1
0
0
0
0
0
0
0
1
0
1
0
0
0
0
1
0
0
```

**Sample Input 2**

```
20 2 2
76.8620 12.3330
115.0418 -8.1833
20.5833 46.1667
6.8624 4.7361
144.8990 -37.8635
15.7167 45.7667
11.1121 33.5040
-4.9526 31.6923
-98.8467 19.3097
133.9340 -32.3784
-96.9674 20.2969
127.2892 42.4322
138.5542 -34.8977
-89.5440 44.4564
151.3157 -33.4650
108.1149 -7.4328
4.5419 35.7058
-4.8252 41.2764
124.0511 6.5519
-99.3430 19.4462
```

**Sample Output 2**

```
1
1
0
0
1
0
0
0
0
1
0
1
1
0
1
1
0
0
1
0
```

**Sample Input 3**

```
100 5 0
113.5469 31.2294
-79.0333 9.5167
-122.1018 47.9934
147.1510 -41.4384
7.0186 8.8835
82.6712 53.5044
29.9419 -0.8411
3.6912 36.1477
-89.2853 32.4513
-73.9976 40.8482
7.9337 11.9160
-2.3333 53.3500
1.3519 43.4798
153.1532 -27.4919
26.1047 35.2078
153.4307 -29.1178
28.7425 -25.8102
144.7666 -37.7672
21.2572 -34.0934
111.2145 -6.7089
150.4857 -34.4010
-122.5255 37.9044
98.3390 7.8447
151.0690 -34.0383
101.1556 19.1503
-0.4896 53.8195
34.6333 -11.0833
115.9667 -32.0333
150.9154 -33.6821
-0.2355 51.9327
4.0498 7.3772
152.7502 -27.6423
14.3011 50.6611
-92.2568 14.5623
20.4144 43.7467
22.7167 -20.4667
-93.5761 44.5433
-99.4697 19.0181
38.8783 15.5091
107.5368 -7.4035
-97.4770 35.1412
115.8126 -32.0332
15.0448 40.2263
-5.1501 42.0328
8.3554 8.3931
-78.2181 39.0834
12.2237 52.8856
19.4933 51.1689
35.0062 1.0157
-99.3321 19.4815
10.4707 2.0164
-72.6779 40.8812
-86.7792 36.0251
-91.4724 17.0841
-55.5809 -27.3674
152.5625 -25.1083
7.5169 50.6230
117.1465 -20.7723
113.3000 25.3722
27.1520 -23.1072
120.9051 15.0292
2.4475 36.5897
73.6758 42.8247
-1.0924 35.3914
-78.4067 36.3082
116.1376 39.7280
116.4336 40.0250
-5.2733 34.6745
110.3255 19.4429
115.9667 -31.8833
-3.3239 39.9019
12.2510 45.9139
6.4943 45.8620
109.9603 20.8980
-57.8809 -36.8627
122.0171 11.7403
-97.0384 37.0620
5.2000 9.4333
117.9856 26.9609
-100.7468 20.6725
-6.4003 40.7058
105.7007 -6.7454
116.4752 -32.8007
150.5366 -34.7381
35.5888 6.9986
138.5433 -35.2189
138.9283 -33.6717
103.8310 25.7572
145.5565 -42.0805
-86.1155 40.8223
110.8289 30.9357
151.1509 -33.6208
152.8601 -27.6128
151.0078 -33.8229
32.1833 12.3500
15.3237 40.1516
-2.9167 51.9333
123.0900 10.9329
50.3150 33.2205
81.1075 26.7679
```

**Sample Output 3**

```
1
3
4
1
0
1
0
0
3
3
0
0
0
1
0
1
0
1
0
1
1
4
1
1
1
0
0
1
1
0
0
1
0
3
0
0
3
3
0
1
3
1
0
0
0
3
0
0
0
3
0
3
3
3
2
1
0
1
1
0
1
0
1
0
3
1
1
0
1
1
0
0
0
1
2
1
3
0
1
3
0
1
1
1
0
1
1
1
1
3
1
1
1
1
0
0
0
1
0
1
```

**Sample Input 4**

```
100 5 1
-103.3333 20.5222
111.5043 -6.8396
-96.7844 16.8694
-88.3707 43.5869
26.4167 -20.5833
27.3316 -20.9907
3.2358 13.6132
118.9918 32.7315
139.0491 -34.7749
151.6116 -33.0423
-36.8403 -10.2111
114.9346 24.4533
33.8849 0.2398
-78.6439 41.9559
122.1981 -8.6951
144.3607 -38.1471
78.3978 27.1509
-1.2775 48.3402
144.9595 -37.6639
115.1544 22.8135
-69.7010 8.4403
112.4232 -7.0510
25.7908 35.0486
151.2552 -33.9205
31.7500 -19.0667
-0.4370 44.8511
5.4965 47.0458
8.2651 12.6586
115.7306 -31.7355
11.9005 54.1071
4.4875 51.7967
30.9855 2.4167
78.8414 10.6337
23.8860 54.9291
120.0754 30.4461
123.1414 -8.3207
151.2883 -33.7980
13.5013 52.5461
112.4484 -6.8776
20.3772 41.7294
145.1305 -38.0148
116.0276 -31.9519
138.6139 -32.7344
82.5605 23.2621
80.5184 41.0836
-89.0467 37.0517
-99.6122 19.3761
-122.0733 37.0513
12.9533 42.0033
151.1251 -33.9209
-85.7061 41.6753
1.6559 49.1380
7.3115 48.1804
-14.0167 13.3667
-98.7672 19.0543
-79.9122 8.7069
115.5625 40.0012
147.3244 -42.8945
-151.2953 59.7361
2.9531 42.6542
26.4974 44.5031
100.5966 16.1600
150.7311 -34.9075
115.7247 -31.6828
24.5631 38.9042
20.1211 -33.7866
153.2333 -27.7333
-102.2842 19.9494
111.1360 -6.8366
3.4251 50.3681
-78.7006 38.0696
138.6049 -35.0405
24.2008 -13.5927
1.7884 12.0731
-122.7620 45.4807
-111.9488 35.2606
29.8818 -27.3654
-5.9114 6.6210
34.9243 32.4079
21.2561 -28.4478
-0.1620 53.5810
13.4925 -14.9172
151.2613 -32.8886
120.9543 31.3776
43.8779 40.3917
123.2520 -8.3140
151.3511 -32.6555
-10.1336 8.5674
-101.6760 20.4836
-71.4745 44.4190
15.5960 5.9340
7.3183 6.7090
14.5754 45.0274
144.2527 -36.7726
-66.4454 18.3513
-99.6242 19.2371
1.5093 43.5024
9.9389 12.3334
11.0458 43.2605
13.4179 11.6533
```

**Sample Output 4**

```
4
1
4
4
0
0
0
3
1
1
0
3
0
4
1
1
3
0
1
3
4
1
0
1
0
0
0
0
1
0
0
0
3
0
3
1
1
0
1
0
1
1
1
3
3
4
4
2
0
1
4
0
0
0
4
4
3
1
2
0
0
3
1
1
0
0
1
4
1
0
4
1
0
0
2
2
0
0
0
0
0
0
1
3
0
1
1
0
4
4
0
0
0
1
4
4
0
0
0
0
```

**Sample Input 5**

```
100 2 2
-94.5830 32.3874
2.7882 44.1822
130.1528 42.8136
88.4621 27.0562
27.8380 -26.0367
71.1916 39.2197
145.9365 -30.0901
-2.4994 50.9794
-75.3525 41.4274
28.4464 -14.4469
36.8883 -17.8786
9.1361 36.3280
97.1011 3.4034
113.3138 -8.2461
24.0852 -29.6246
151.6685 -33.0208
112.5668 23.2039
-104.7186 19.2439
-84.1966 33.1168
14.1867 12.3405
12.2167 50.5000
4.5812 10.7061
-81.9084 28.0356
99.9010 33.9686
-12.0516 28.0946
9.1081 9.9910
143.0424 -22.3819
117.3727 39.2664
-101.1249 19.0197
-104.5436 20.9150
138.5531 -35.0042
-82.0308 8.4580
151.5833 -32.9833
-79.5475 35.0324
-89.9193 36.4520
151.1764 -33.8897
5.0167 52.3058
85.1441 56.3680
123.9218 9.6875
-68.9978 44.5212
110.8680 30.1755
-80.8112 37.3315
120.8792 53.8603
-98.0339 20.4900
-92.6285 16.3506
3.0782 49.1375
150.9986 -33.7838
150.3055 -28.5471
-96.7446 16.2540
14.2069 12.3730
10.8539 33.8206
151.2537 -33.8055
138.4710 -35.1480
10.7667 53.7167
122.2392 -17.9554
22.3294 51.3552
108.9450 34.1511
-6.1634 40.1935
107.3958 29.7060
22.0254 40.7934
30.4167 -0.9000
114.8275 31.3021
24.3500 37.6333
10.7288 10.3744
19.6014 44.3731
136.8667 35.4167
138.8676 -35.5101
108.1693 30.5662
-93.0603 17.2303
26.5133 47.4502
-95.0160 29.3483
-2.8871 42.4478
2.0860 14.3164
120.4358 15.6169
146.7856 -37.9813
150.7918 -34.5663
13.9617 46.6792
106.9267 -6.9181
-1.1270 43.6127
-0.8336 47.6012
-0.0146 47.7183
5.6111 51.3517
3.8815 35.6700
-92.1918 32.5160
106.8542 -6.4817
109.1026 34.1305
-66.3670 -23.3986
-103.4613 21.4634
-62.7195 -31.8721
37.3481 -1.3034
-5.3023 34.4774
11.0406 12.8740
23.8833 -24.4000
151.3238 -33.5966
153.0032 -25.9191
144.8431 -34.5090
13.8561 46.6063
150.6655 -33.7752
3.3947 6.4541
145.2968 -38.1364
```

**Sample Output 5**

```
0
0
1
1
0
1
1
0
0
0
0
0
1
1
0
1
1
0
0
0
0
0
0
1
0
0
1
1
0
0
1
0
1
0
0
1
0
1
1
0
1
0
1
0
0
0
1
1
0
0
0
1
1
0
1
0
1
0
1
0
0
1
0
0
0
1
1
1
0
0
0
0
0
1
1
1
0
1
0
0
0
0
0
0
1
1
0
0
0
0
0
0
0
1
1
1
0
1
0
1
```



